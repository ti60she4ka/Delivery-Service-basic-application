<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-20">
    <createTable tableName="revinfo">
      <column name="rev" type="INTEGER" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="revinfo_pkey"/>
      </column>
      <column name="revtstmp" type="BIGINT"/>
    </createTable>
  </changeSet>

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-23">
    <createTable tableName="article_aud">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="article_aud_pkey"/>
      </column>
      <column name="rev" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="article_aud_pkey"/>
      </column>
      <column name="revtype" type="SMALLINT"/>
      <column name="price" type="${double}"/>
      <column name="quantity" type="INTEGER"/>
      <column name="product_id" type="BIGINT"/>
      <column name="shop_id" type="BIGINT"/>
    </createTable>

    <addForeignKeyConstraint
      baseColumnNames="rev"
      baseTableName="article_aud"
      constraintName="article_aud_rev_fkey"
      referencedColumnNames="rev"
      referencedTableName="revinfo"/>
  </changeSet>

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-25">
    <createTable tableName="product_aud">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="product_aud_pkey"/>
      </column>
      <column name="rev" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="product_aud_pkey"/>
      </column>
      <column name="revtype" type="SMALLINT"/>
      <column name="name" type="VARCHAR(255)"/>
    </createTable>

    <addForeignKeyConstraint
      baseColumnNames="rev"
      baseTableName="product_aud"
      constraintName="product_aud_rev_fkey"
      referencedColumnNames="rev"
      referencedTableName="revinfo"/>
  </changeSet>

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-26">
    <createTable tableName="users_aud">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="users_aud_pkey"/>
      </column>
      <column name="rev" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="users_aud_pkey"/>
      </column>
      <column name="revtype" type="SMALLINT"/>
      <column name="address" type="VARCHAR(255)"/>
      <column name="email" type="VARCHAR(255)"/>
      <column name="first_name" type="VARCHAR(255)"/>
      <column name="last_name" type="VARCHAR(255)"/>
      <column name="password" type="VARCHAR(255)"/>
      <column name="phone_number" type="VARCHAR(255)"/>
      <column name="role" type="VARCHAR(255)"/>
      <column name="username" type="VARCHAR(255)"/>
    </createTable>

    <addForeignKeyConstraint
      baseColumnNames="rev"
      baseTableName="users_aud"
      constraintName="users_aud_rev_fkey"
      referencedColumnNames="rev"
      referencedTableName="revinfo"/>
  </changeSet>

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-27">
    <createTable tableName="category_aud">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="category_aud_pkey"/>
      </column>
      <column name="rev" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="category_aud_pkey"/>
      </column>
      <column name="revtype" type="SMALLINT"/>
      <column name="name" type="VARCHAR(255)"/>
      <column name="parent_id" type="BIGINT"/>
    </createTable>

    <addForeignKeyConstraint
      baseColumnNames="rev"
      baseTableName="category_aud"
      constraintName="category_aud_rev_fkey"
      referencedColumnNames="rev"
      referencedTableName="revinfo"/>
  </changeSet>

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-30">
    <createTable tableName="product_category_aud">
      <column name="rev" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="product_category_aud_pkey"/>
      </column>
      <column name="product_id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="product_category_aud_pkey"/>
      </column>
      <column name="category_id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="product_category_aud_pkey"/>
      </column>
      <column name="revtype" type="SMALLINT"/>
    </createTable>

    <addForeignKeyConstraint
      baseColumnNames="rev"
      baseTableName="product_category_aud"
      constraintName="product_category_aud_rev_fkey"
      referencedColumnNames="rev"
      referencedTableName="revinfo"/>
  </changeSet>

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-34">
    <createTable tableName="attribute_aud">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="attribute_aud_pkey"/>
      </column>
      <column name="rev" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="attribute_aud_pkey"/>
      </column>
      <column name="revtype" type="SMALLINT"/>
      <column name="description" type="VARCHAR(255)"/>
      <column name="name" type="VARCHAR(255)"/>
      <column name="type" type="VARCHAR(255)"/>
      <column name="value" type="VARCHAR(255)"/>
      <column name="product_id" type="BIGINT"/>
    </createTable>

    <addForeignKeyConstraint
      baseColumnNames="rev"
      baseTableName="attribute_aud"
      constraintName="attribute_aud_rev_fkey"
      referencedColumnNames="rev"
      referencedTableName="revinfo"/>
  </changeSet>

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-36">
    <createTable tableName="orders_aud">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="orders_aud_pkey"/>
      </column>
      <column name="rev" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="orders_aud_pkey"/>
      </column>
      <column name="revtype" type="SMALLINT"/>
      <column name="completion_date" type="date"/>
      <column name="creation_date" type="date"/>
      <column name="status" type="VARCHAR(255)"/>
      <column name="total_cost" type="${double}"/>
      <column name="update_date" type="date"/>
      <column name="user_id" type="BIGINT"/>
    </createTable>

    <addForeignKeyConstraint
      baseColumnNames="rev"
      baseTableName="orders_aud"
      constraintName="orders_aud_rev_fkey"
      referencedColumnNames="rev"
      referencedTableName="revinfo"/>
  </changeSet>

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-40">
    <createTable tableName="order_item_aud">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="order_item_aud_pkey"/>
      </column>
      <column name="rev" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="order_item_aud_pkey"/>
      </column>
      <column name="revtype" type="SMALLINT"/>
      <column name="price" type="${double}"/>
      <column name="quantity" type="INTEGER"/>
      <column name="article_id" type="BIGINT"/>
      <column name="order_id" type="BIGINT"/>
    </createTable>

    <addForeignKeyConstraint
      baseColumnNames="rev"
      baseTableName="order_item_aud"
      constraintName="order_item_aud_rev_fkey"
      referencedColumnNames="rev"
      referencedTableName="revinfo"/>
  </changeSet>

  <changeSet author="Pavel Avtaev" id="15-08-2021-23-42">
    <createTable tableName="shop_aud">
      <column name="id" type="BIGINT">
        <constraints nullable="false" primaryKey="true" primaryKeyName="shop_aud_pkey"/>
      </column>
      <column name="rev" type="INTEGER">
        <constraints nullable="false" primaryKey="true" primaryKeyName="shop_aud_pkey"/>
      </column>
      <column name="revtype" type="SMALLINT"/>
      <column name="address" type="VARCHAR(255)"/>
      <column name="city" type="VARCHAR(255)"/>
      <column name="name" type="VARCHAR(255)"/>
    </createTable>

    <addForeignKeyConstraint
      baseColumnNames="rev"
      baseTableName="shop_aud"
      constraintName="shop_aud_rev_fkey"
      referencedColumnNames="rev"
      referencedTableName="revinfo"/>
  </changeSet>

</databaseChangeLog>